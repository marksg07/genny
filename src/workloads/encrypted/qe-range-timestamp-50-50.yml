SchemaVersion: 2018-07-01
Owner: "@10gen/server-security"
Description: |
  QE Range Release Criteria Experiment
Keywords:
- Queryable Encryption

GlobalDefaults:
  MyDatabase: &encrypted_db genny_release_criteria
  MyCollection: &encrypted_coll my_coll
  NopAlias: &nop {Nop: true}
  
  StateTransitions: &transitions
  - To: Query
    Weight: 0.5
    SleepBefore: {^TimeSpec: {value: 0, unit: seconds}}
  - To: Update
    Weight: 0.5
    SleepBefore: {^TimeSpec: {value: 0, unit: seconds}}
  


Encryption:
  
  UseCryptSharedLib: true
  CryptSharedLibPath: /data/workdir/mongocrypt/lib/mongo_crypt_v1.so
  
  EncryptedCollections:
  - Database: *encrypted_db
    Collection: *encrypted_coll
    EncryptionType: queryable

    QueryableEncryptedFields:
      tm_retail_tx: { type: "long", queries: [{queryType: "range", min: 0, max: 1000000000000, contention: 4, sparsity: 2, trimFactor: 8}] }
      age_hospitals: { type: "int",  queries: [{queryType: "range", min: 0, max: 55000, contention: 8, sparsity: 2, trimFactor: 6}] }
      bnk_bal: { type: "decimal", queries: [{queryType: "range", min: 0, max: 1000000, precision: 2, contention: 8, sparsity: 2, trimFactor: 6}] }


Clients:
  EncryptedPool:
    QueryOptions:
      maxPoolSize: 400
  
    EncryptionOptions:
      KeyVaultDatabase: "keyvault"
      KeyVaultCollection: "datakeys"
      EncryptedCollections:
      - genny_release_criteria.my_coll
  

Actors:

  
  
  - Name: InsertActor_Thread0
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 0}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 0}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 0}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread1
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 6250}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 6250}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 6250}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread2
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 12500}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 12500}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 12500}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread3
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 18750}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 18750}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 18750}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread4
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 25000}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 25000}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 25000}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread5
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 31250}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 31250}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 31250}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread6
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 37500}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 37500}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 37500}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread7
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 43750}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 43750}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 43750}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread8
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 50000}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 50000}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 50000}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread9
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 56250}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 56250}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 56250}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread10
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 62500}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 62500}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 62500}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread11
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 68750}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 68750}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 68750}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread12
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 75000}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 75000}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 75000}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread13
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 81250}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 81250}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 81250}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread14
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 87500}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 87500}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 87500}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    
  - Name: InsertActor_Thread15
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    Phases:
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "load"
      Operations:
      - OperationName: insertOne
        OperationMetricsName: inserts
        OperationCommand:
          Document:
            tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt", "sequential": true, "startFromLine": 93750}}}}
            age_hospitals: {^ConvertToInt32: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_ages.txt", "sequential": true, "startFromLine": 93750}}}}
            bnk_bal: {^ConvertToDecimal: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_balances.txt", "sequential": true, "startFromLine": 93750}}}}

            _id: {^Inc: {start: 0, multiplier: 500000}}
    - *nop
    


  
  - Name: FSMActor_Thread0
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 0}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 0}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread1
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 6250}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 6250}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread2
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 12500}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 12500}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread3
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 18750}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 18750}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread4
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 25000}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 25000}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread5
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 31250}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 31250}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread6
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 37500}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 37500}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread7
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 43750}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 43750}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread8
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 50000}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 50000}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread9
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 56250}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 56250}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread10
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 62500}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 62500}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread11
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 68750}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 68750}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread12
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 75000}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 75000}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread13
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 81250}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 81250}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread14
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 87500}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 87500}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions

  - Name: FSMActor_Thread15
    Type: CrudActor
    Threads: 1
    Database: *encrypted_db
    ClientName: EncryptedPool
    
    Phases:
    - *nop
    - *nop
    - Repeat: 6250
      Collection: *encrypted_coll
      MetricsName: "FSM"
      InitialStates:
        - State: Query
          Weight: 0.5
        - State: Update
          Weight: 0.5
      States:
        - Name: Query
          Operations:
          - OperationName: find
            OperationMetricsName: range_query
            OperationCommand:
              Filter: { tm_retail_tx: {
                  $gte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_min.txt", "sequential": true, "startFromLine": 93750}}}},
                  $lte: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/queries/rc_timestamp_t3_max.txt", "sequential": true, "startFromLine": 93750}}}}
                }
              }
          Transitions: *transitions
        - Name: Update
          Operations:
          - OperationName: updateOne
            OperationMetricsName: update
            OperationCommand:
              Filter: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps_up.txt"}}}}}
              Update: {$set: { tm_retail_tx: {^ConvertToInt: {from: {^ChooseFromDataset:{"path": "./src/genny/src/workloads/contrib/qe_range_testing/data/rc_timestamps.txt"} } } } } }
          Transitions: *transitions



  - Name: LoggingActor0
    Type: LoggingActor
    Threads: 1
    Phases:
      - *nop
      - Phase: 1..2
        LogEvery: 5 minutes
        Blocking: None

AutoRun:
- When:
    mongodb_setup:
      $eq:
      - single-replica-fle
      - shard-lite-fle
    branch_name:
      $gte: v7.0